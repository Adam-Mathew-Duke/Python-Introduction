# Binaural Beats
# Version 1 - Terminal
# add some more error handling
# do some more testing
# polish my code and comments
# publish to github and move onto version 2

import os
from AccelBrainBeat.brainbeat.binaural_beat import BinauralBeat

class create_binural_beat:

    def __init__(self):
        self.left_channel = 130
        self.right_channel = self.left_channel + 10
        self.preview_duration = 5
        self.save_duration = 60
        self.volume = 0.5
        self.beat = BinauralBeat()

    def beat_info(self,state):
        
        if state == "play":
            print ("\nNow Playing:")
        elif state == "save":
            print ("\nNow Saving:")
        
        print("Left frequency: "+str(self.left_channel)+"Hz")
        print("Right frequency: "+str(self.right_channel)+"Hz")
        print("Phantom frequency: "+str(self.right_channel-self.left_channel)+"Hz")
        print("Duration: "+str(self.preview_duration))
        print("Volume: "+str(self.volume))

    def create_beat(self,frequency):
        self.left_channel = frequency
        self.right_channel = self.left_channel + 10
        self.beat_info("play") 
        self.beat.play_beat(
        	frequencys=(self.left_channel,self.right_channel),
        	play_time=self.preview_duration,
        	volume=self.volume)

    def save_beat(self,frequency):
        self.beat_info("save")
        self.left_channel = frequency
        self.right_channel = self.left_channel + 10
        filename = str(self.left_channel) + "Hz - Binural Beat Audio.wav"
        self.beat.save_beat(
            output_file_name=filename,
            frequencys=(self.left_channel,self.right_channel),
        	play_time=self.save_duration,
        	volume=self.volume
        )

def main_menu():

    os.system("cls")
    print("\nBinural Beats\n")
    print("1. Set Frequency")
    print("2. Play Beat Preview (5 seconds)")
    print("3. Save Beat (1 minute)")
    print("4. Exit Program\n")
    choice = input("Your choice: ")
    choice = int(choice)
    return choice

choice = main_menu()
choice2 = create_binural_beat().left_channel

def error_message():
    print("130Hz selected as your choice was outside the frequency range.")
    input("Press anykey to continue.")
    choice2 = 130
    choice2 = int(choice2)
    return choice2

while True:

    if choice == 1:
        choice2 = input("Choose frequency (between 130 and 180): ")
        
        try:
            choice2 = int(choice2)
        except:
            choice2 = error_message()

        if choice2 < 130 or choice2 > 180:
            error_message()
        choice = main_menu()

    elif choice == 2:
        beat = create_binural_beat()
        beat.create_beat(choice2)
        choice = main_menu()

    elif choice == 3:
        beat = create_binural_beat()
        beat.save_beat(choice2)
        choice = main_menu()

    elif choice == 4:
        break

# end of code
